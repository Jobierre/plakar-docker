.Dd September 10, 2025
.Dt PLAKAR-PRUNE 1
.Os
.Sh NAME
.Nm plakar-prune
.Nd Prune snapshots according to a policy
.Sh SYNOPSIS
.Nm plakar prune
.Op Fl apply
.Op Fl policy Ar name
.Op Ar snapshotID ...
.Sh DESCRIPTION
The
.Nm plakar prune
command deletes snapshots from a Plakar repository.
Snapshots can be filtered for deletion by age, by tag, or by
specifying the snapshot IDs to remove.
If no
.Ar snapshotID
are provided, either
.Fl older
or
.Fl tag
must be specified to filter the snapshots to delete.
.Pp
.Nm plakar prune
supports the location flags documented in
.Xr plakar-query 7
to precisely select snapshots.
.Pp
The arguments are as follows:
.Bl -tag -width Ds
.It Fl apply
Delete matching snapshot.
The default is to just show the snapshot that would be removed but not
actually execute the operation.
.It Fl policy Ar name
Use the given policy.
See
.Xr plakar-policy 1
for how policies are managed.
.El
.Sh EXAMPLES
Remove a specific snapshot by ID:
.Bd -literal -offset indent
$ plakar prune abc123
.Ed
.Pp
Remove snapshots older than 30 days:
.Bd -literal -offset indent
$ plakar prune -days 30d
.Ed
.Pp
Remove snapshots with a specific tag:
.Bd -literal -offset indent
$ plakar prune -tag daily-backup
.Ed
.Pp
Remove snapshots older than 1 year with a specific tag:
.Bd -literal -offset indent
$ plakar prune -years 1 -tag daily-backup
.Ed
.Sh DIAGNOSTICS
.Ex -std
.Bl -tag -width Ds
.It 0
Command completed successfully.
.It >0
An error occurred, such as invalid date format or failure to delete a
snapshot.
.El
.Sh SEE ALSO
.Xr plakar 1 ,
.Xr plakar-backup 1 ,
.Xr plakar-policy 1 ,
.Xr plakar-query 7
