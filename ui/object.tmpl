{{template "base" .}}

{{define "title"}}{{.Snapshot.Uuid}}{{end}}

{{define "main"}}
    {{$Snapshot:=.Snapshot}}
    {{$Object:=.Object}}
    {{$Info:=.Info}}
    {{$Path:=.Path}}
    {{$Navigation:=.Navigation}}

    <nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/">plakar</a></li>
        <li class="breadcrumb-item"><a href="/snapshot/{{$Snapshot.Uuid}}">{{$Snapshot.Uuid}}</a></li>
        {{range $atom := $Navigation }}
            <li class="breadcrumb-item" aria-current="page"><a href="/snapshot/{{$Snapshot.Uuid}}:{{$atom}}">{{$atom}}</a></li>
        {{end}}
    </ol>
    </nav>

    <h2>Informations</h2>
    <table class="table table-striped">
        <thead>
            <tr>
                <th scope="col">Metadata</th>
                <th scope="col">Value</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Checksum</td>
                <td>{{$Object.Checksum}}</td>
            </tr>
            <tr>
                <td>Content-Type</td>
                <td>{{$Object.ContentType}}</td>
            </tr>
            <tr>
                <td>Name</td>
                <td>{{$Info.Name}}</td>
            </tr>
            <tr>
                <td>Size</td>
                <td>{{$Info.HumanSize}} ({{$Info.Size}})</td>
            </tr>
            <tr>
                <td>Mode</td>
                <td>{{$Info.Mode}}</td>
            </tr>
            <tr>
                <td>Uid</td>
                <td>{{$Info.Uid}}</td>
            </tr>
            <tr>
                <td>Gid</td>
                <td>{{$Info.Gid}}</td>
            </tr>
            <tr>
                <td>Device</td>
                <td>{{$Info.Dev}}</td>
            </tr>
            <tr>
                <td>Inode</td>
                <td>{{$Info.Ino}}</td>
            </tr>
            <tr>
                <td>Modification Time</td>
                <td>{{$Info.ModTime}}</td>
            </tr>
        </tbody>
    </table>

    <h2>Structure</h2>
    <table class="table table-striped">
        <thead>
            <tr>
                <th scope="col">Chunk</th>
                <th scope="col">Offset</th>
                <th scope="col">Length</th>
            </tr>
        </thead>
        <tbody>
            {{range $chunk := $Object.Chunks}} 
            <tr>
                <td>{{$chunk.Checksum}}</td>
                <td>{{$chunk.Start}}</td>
                <td>{{$chunk.Length}}</td>
            </tr>
            {{end}}
        </tbody>
    </table>

    {{if .EnableViewer}}
    <!-- Button trigger modal -->
    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
    View {{$Info.Name}}
    </button>

    <!-- Modal -->
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-fullscreen">
            <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">{{$Info.Name}}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <iframe width="100%" height="100%" src="/raw/{{$Snapshot.Uuid}}:{{$Path}}?raw"></iframe>
            </div>
            </div>
        </div>
    </div>
    {{end}}
{{end}}